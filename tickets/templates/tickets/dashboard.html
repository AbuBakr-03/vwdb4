{% extends "tickets/base.html" %} {% block page_title %}Dashboard{% endblock %}
{% block page_header %}Ticket Dashboard{% endblock %} {% block page_subtitle %}
<p class="text-base-content/70">
  Overview of all tickets and system statistics
</p>
{% endblock %} {% block page_actions %}
<a href="{% url 'tickets:ticket_create' %}" class="btn btn-primary">
  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
    <path
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="2"
      d="M12 4v16m8-8H4"
    ></path>
  </svg>
  New Ticket
</a>
{% endblock %} {% block tickets_content %}
<!-- Statistics Cards -->
<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
  <div class="stat bg-base-100 shadow rounded-lg">
    <div class="stat-figure text-primary">
      <svg
        class="w-8 h-8"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
        ></path>
      </svg>
    </div>
    <div class="stat-title">Total Tickets</div>
    <div class="stat-value text-primary">{{ total_tickets }}</div>
  </div>

  <div class="stat bg-base-100 shadow rounded-lg">
    <div class="stat-figure text-warning">
      <svg
        class="w-8 h-8"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
        ></path>
      </svg>
    </div>
    <div class="stat-title">Open Tickets</div>
    <div class="stat-value text-warning">{{ open_tickets }}</div>
  </div>

  <div class="stat bg-base-100 shadow rounded-lg">
    <div class="stat-figure text-info">
      <svg
        class="w-8 h-8"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M13 10V3L4 14h7v7l9-11h-7z"
        ></path>
      </svg>
    </div>
    <div class="stat-title">In Progress</div>
    <div class="stat-value text-info">{{ in_progress_tickets }}</div>
  </div>

  <div class="stat bg-base-100 shadow rounded-lg">
    <div class="stat-figure text-success">
      <svg
        class="w-8 h-8"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"
        ></path>
      </svg>
    </div>
    <div class="stat-title">Resolved</div>
    <div class="stat-value text-success">{{ resolved_tickets }}</div>
  </div>
</div>

<!-- Charts and Recent Tickets -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
  <!-- Tickets by Status -->
  <div class="card bg-base-100 shadow">
    <div class="card-body">
      <h2 class="card-title">Tickets by Status</h2>
      <div class="space-y-3">
        {% for status_data in tickets_by_status %}
        <div class="flex justify-between items-center">
          <span class="capitalize">{{ status_data.status|title }}</span>
          <div class="flex items-center gap-2">
            <div class="w-32 bg-base-300 rounded-full h-2">
              <div
                class="bg-primary h-2 rounded-full"
                style="width: {% widthratio status_data.count total_tickets 100 %}%"
              ></div>
            </div>
            <span class="text-sm font-medium">{{ status_data.count }}</span>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>

  <!-- Tickets by Priority -->
  <div class="card bg-base-100 shadow">
    <div class="card-body">
      <h2 class="card-title">Tickets by Priority</h2>
      <div class="space-y-3">
        {% for priority_data in tickets_by_priority %}
        <div class="flex justify-between items-center">
          <span class="capitalize">{{ priority_data.priority|title }}</span>
          <div class="flex items-center gap-2">
            <div class="w-32 bg-base-300 rounded-full h-2">
              <div
                class="bg-secondary h-2 rounded-full"
                style="width: {% widthratio priority_data.count total_tickets 100 %}%"
              ></div>
            </div>
            <span class="text-sm font-medium">{{ priority_data.count }}</span>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>

<!-- Recent Tickets -->
<div class="card bg-base-100 shadow mt-8">
  <div class="card-body">
    <div class="flex justify-between items-center mb-4">
      <h2 class="card-title">Recent Tickets</h2>
      <a href="{% url 'tickets:ticket_list' %}" class="btn btn-sm btn-outline"
        >View All</a
      >
    </div>

    {% if recent_tickets %}
    <div class="overflow-x-auto">
      <table class="table table-zebra">
        <thead>
          <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Submitter</th>
            <th>Status</th>
            <th>Priority</th>
            <th>Assigned To</th>
            <th>Created</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for ticket in recent_tickets %}
          <tr>
            <td>
              <span class="badge badge-outline">{{ ticket.get_short_id }}</span>
            </td>
            <td>
              <a
                href="{% url 'tickets:ticket_detail' ticket.pk %}"
                class="link link-hover font-medium"
              >
                {{ ticket.title|truncatechars:50 }}
              </a>
            </td>
            <td>{{ ticket.submitter.username }}</td>
            <td>
              <span class="badge badge-{{ ticket.status }}">
                {{ ticket.get_status_display }}
              </span>
            </td>
            <td>
              <span class="badge badge-{{ ticket.priority }}">
                {{ ticket.get_priority_display }}
              </span>
            </td>
            <td>
              {% if ticket.assigned_to %} {{ ticket.assigned_to.username }} {%
              else %}
              <span class="text-base-content/50">Unassigned</span>
              {% endif %}
            </td>
            <td>{{ ticket.created_at|date:"M d, Y" }}</td>
            <td>
              <div class="flex gap-1">
                <a
                  href="{% url 'tickets:ticket_detail' ticket.pk %}"
                  class="btn btn-xs btn-outline"
                  >View</a
                >
                <a
                  href="{% url 'tickets:ticket_update' ticket.pk %}"
                  class="btn btn-xs btn-primary"
                  >Edit</a
                >
              </div>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    </div>
    {% else %}
    <div class="text-center py-8">
      <svg
        class="w-16 h-16 mx-auto text-base-content/30 mb-4"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
        ></path>
      </svg>
      <p class="text-base-content/70">No tickets found</p>
      <a href="{% url 'tickets:ticket_create' %}" class="btn btn-primary mt-4"
        >Create First Ticket</a
      >
    </div>
    {% endif %}
  </div>
</div>

<!-- Quick Actions -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
  <div class="card bg-base-100 shadow">
    <div class="card-body text-center">
      <svg
        class="w-12 h-12 mx-auto text-primary mb-4"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M12 4v16m8-8H4"
        ></path>
      </svg>
      <h3 class="card-title justify-center">Create Ticket</h3>
      <p class="text-base-content/70 mb-4">Submit a new ticket for QA review</p>
      <a href="{% url 'tickets:ticket_create' %}" class="btn btn-primary"
        >New Ticket</a
      >
    </div>
  </div>

  <div class="card bg-base-100 shadow">
    <div class="card-body text-center">
      <svg
        class="w-12 h-12 mx-auto text-info mb-4"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"
        ></path>
      </svg>
      <h3 class="card-title justify-center">View Tickets</h3>
      <p class="text-base-content/70 mb-4">Browse and manage all tickets</p>
      <a href="{% url 'tickets:ticket_list' %}" class="btn btn-outline"
        >View All</a
      >
    </div>
  </div>

  <div class="card bg-base-100 shadow">
    <div class="card-body text-center">
      <svg
        class="w-12 h-12 mx-auto text-success mb-4"
        fill="none"
        stroke="currentColor"
        viewBox="0 0 24 24"
      >
        <path
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"
        ></path>
      </svg>
      <h3 class="card-title justify-center">Manage Companies</h3>
      <p class="text-base-content/70 mb-4">
        Manage partner companies and testers
      </p>
      <a href="{% url 'tickets:company_list' %}" class="btn btn-outline"
        >Companies</a
      >
    </div>
  </div>
</div>
{% endblock %}




