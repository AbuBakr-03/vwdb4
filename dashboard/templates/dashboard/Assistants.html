{% extends 'base.html' %}
{% block title %}Assistants - Watchtower{% endblock %}

{% block secondary_sidebar %}
<!-- Secondary Sidebar for Assistants -->
<aside class="w-80 bg-base-200 border-r border-base-content/10 flex flex-col">
  <!-- Header with Title and Docs Button -->
  <div class="flex items-center justify-between px-4 py-4 border-b border-base-content/10">
    <div class="flex items-center space-x-2">
      <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
      </svg>
      <h2 class="text-lg font-semibold text-base-content">Assistants</h2>
    </div>
    <button class="btn btn-ghost btn-sm">
      <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
      </svg>
      Docs
    </button>
  </div>

  <!-- Create Assistant Button -->
  <div class="px-4 py-3">
    <button class="btn btn-primary w-full">
      <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
      </svg>
      Create Assistant
    </button>
  </div>

  <!-- Search Box -->
  <div class="px-4 py-2">
    <div class="relative">
      <input type="text" placeholder="Search Assistants" class="input input-sm w-full bg-base-300/50 border-none text-sm pl-8">
      <svg class="w-4 h-4 absolute left-2 top-1/2 transform -translate-y-1/2 text-base-content/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
      </svg>
    </div>
  </div>

  <!-- Assistants List -->
  <div class="flex-1 px-4 py-2 overflow-y-auto">
    <div class="space-y-1">
      <!-- Assistant Item - Selected -->
      <div class="p-3 rounded-lg bg-primary/20 border border-primary/30 cursor-pointer transition-colors">
        <div class="flex items-center justify-between">
          <div class="flex-1 min-w-0">
            <h3 class="font-medium text-primary text-sm truncate">Riley</h3>
            <p class="text-xs text-primary/70 truncate">Elliot</p>
          </div>
          <div class="w-2 h-2 bg-primary rounded-full flex-shrink-0"></div>
        </div>
      </div>

      <!-- Assistant Item - Normal -->
      <div class="p-3 rounded-lg hover:bg-base-300/50 cursor-pointer transition-colors">
        <div class="flex items-center justify-between">
          <div class="flex-1 min-w-0">
            <h3 class="font-medium text-base-content/90 text-sm truncate">Customer Support</h3>
            <p class="text-xs text-base-content/60 truncate">General Support Agent</p>
          </div>
          <div class="w-2 h-2 bg-base-content/30 rounded-full flex-shrink-0"></div>
        </div>
      </div>

      <!-- Assistant Item - Normal -->
      <div class="p-3 rounded-lg hover:bg-base-300/50 cursor-pointer transition-colors">
        <div class="flex items-center justify-between">
          <div class="flex-1 min-w-0">
            <h3 class="font-medium text-base-content/90 text-sm truncate">Sales Assistant</h3>
            <p class="text-xs text-base-content/60 truncate">Sales Inquiry Handler</p>
          </div>
          <div class="w-2 h-2 bg-base-content/30 rounded-full flex-shrink-0"></div>
        </div>
      </div>

      <!-- Assistant Item - Normal -->
      <div class="p-3 rounded-lg hover:bg-base-300/50 cursor-pointer transition-colors">
        <div class="flex items-center justify-between">
          <div class="flex-1 min-w-0">
            <h3 class="font-medium text-base-content/90 text-sm truncate">Appointment Booking</h3>
            <p class="text-xs text-base-content/60 truncate">Schedule Management</p>
          </div>
          <div class="w-2 h-2 bg-base-content/30 rounded-full flex-shrink-0"></div>
        </div>
      </div>

      <!-- Assistant Item - Normal -->
      <div class="p-3 rounded-lg hover:bg-base-300/50 cursor-pointer transition-colors">
        <div class="flex items-center justify-between">
          <div class="flex-1 min-w-0">
            <h3 class="font-medium text-base-content/90 text-sm truncate">Technical Support</h3>
            <p class="text-xs text-base-content/60 truncate">Technical Issue Resolver</p>
          </div>
          <div class="w-2 h-2 bg-base-content/30 rounded-full flex-shrink-0"></div>
        </div>
      </div>

      <!-- Assistant Item - Normal -->
      <div class="p-3 rounded-lg hover:bg-base-300/50 cursor-pointer transition-colors">
        <div class="flex items-center justify-between">
          <div class="flex-1 min-w-0">
            <h3 class="font-medium text-base-content/90 text-sm truncate">Lead Qualification</h3>
            <p class="text-xs text-base-content/60 truncate">Lead Scoring Agent</p>
          </div>
          <div class="w-2 h-2 bg-base-content/30 rounded-full flex-shrink-0"></div>
        </div>
      </div>
    </div>
  </div>
</aside>
{% endblock %}

{% block content %}
<!-- Fixed Header -->
<div class="fixed top-0 z-50 bg-neutral text-neutral-content border-b border-neutral-content/20 px-6 py-3" style="left: 320px; right: 0;">
  <div class="flex items-center justify-between">
    <!-- Left: Assistant Name & Status -->
    <div class="flex items-center space-x-3">
      <h1 class="text-lg font-bold text-white">Riley</h1>
      <div class="badge badge-success badge-sm gap-1">
        <div class="w-2 h-2 bg-green-400 rounded-full"></div>
        Published
      </div>
      <span class="text-sm text-neutral-content/60 font-mono">dc8d68a4-3d4c-48b8-b0f5...</span>
      <button class="btn btn-ghost btn-xs text-neutral-content/70 hover:text-white">
        <!-- Lucide Copy icon -->
        <svg class="w-3 h-3" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <rect width="14" height="14" x="8" y="8" rx="2" ry="2"/>
          <path d="m4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/>
        </svg>
      </button>
    </div>
    
    <!-- Right: Segmented Controls + Primary Button -->
    <div class="flex items-center space-x-4">
      <!-- Segmented Control Group -->
      <div class="join bg-white/10 rounded-2xl p-1">
        <button class="join-item btn btn-ghost btn-sm text-neutral-content/80 hover:text-white hover:bg-white/20 border-0 rounded-xl">
          <!-- Lucide Code icon -->
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <polyline points="16,18 22,12 16,6"/>
            <polyline points="8,6 2,12 8,18"/>
          </svg>
          Code
        </button>
        <button class="join-item btn btn-ghost btn-sm text-neutral-content/80 hover:text-white hover:bg-white/20 border-0 rounded-xl">
          <!-- Lucide TestTube icon -->
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path d="m7 10 5 5 5-5"/>
            <path d="m12 15 5-5 5 5"/>
          </svg>
          Test
        </button>
        <button class="join-item btn btn-ghost btn-sm text-neutral-content/80 hover:text-white hover:bg-white/20 border-0 rounded-xl">
          <!-- Lucide MessageSquare icon -->
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
          </svg>
          Chat
        </button>
        <button class="join-item btn btn-ghost btn-sm text-white bg-white/20 border-0 rounded-xl">
          <!-- Lucide Phone icon -->
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
            <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
          </svg>
          Call
        </button>
      </div>
      
      <!-- Primary CTA -->
      <button class="btn btn-primary bg-cyan-500 hover:bg-cyan-600 text-white border-0 rounded-2xl shadow-lg">
        <!-- Lucide Phone icon -->
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/>
        </svg>
        Talk to Assistant
      </button>
      
      <!-- Search -->
      <div class="relative">
        <input type="text" placeholder="Search" class="input input-sm bg-white/10 border-white/20 text-white placeholder-neutral-content/60 w-48 pr-12 text-sm focus:bg-white/20 focus:border-white/40 rounded-2xl">
        <div class="absolute inset-y-0 right-0 flex items-center pr-3">
          <kbd class="kbd kbd-xs bg-white/20 text-neutral-content/80 border-white/30 rounded-xl">âŒ˜ K</kbd>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Bottom Tabs Row -->
  <div class="flex items-center justify-between mt-3 border-t border-neutral-content/20 pt-3">
    <!-- Main Navigation Tabs -->
    <div class="flex items-center space-x-8">
      <a href="#model-section" class="relative flex items-center space-x-2 text-white pb-2 text-sm font-medium transition-colors hover:text-cyan-300" data-section="model">
        <!-- Lucide Lightbulb icon -->
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path d="m15 14 5-5-5-5"/>
          <path d="m20 9H9"/>
          <path d="M5 19v-8a8.38 8.38 0 0 1 .9-3.8 8.5 8.5 0 0 1 7.6-4.7 8.38 8.38 0 0 1 3.8.9"/>
        </svg>
        <span>Model</span>
        <div class="absolute bottom-0 left-0 right-0 h-0.5 bg-cyan-400 shadow-sm shadow-cyan-400/50"></div>
      </a>
      <a href="#voice-section" class="relative flex items-center space-x-2 text-neutral-content/70 hover:text-white pb-2 text-sm transition-colors" data-section="voice">
        <!-- Lucide Mic icon -->
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path d="m12 1 0 6 m-3 7c0 3 2.755 5.7 5.5 6-.35.5-.5 1-.5 1.5a2 2 0 0 1-4 0c0-.5-.15-1-.5-1.5 2.745-.3 5.5-3 5.5-6z"/>
          <path d="m19 10c0 1.5-2 5.5-7 5.5s-7-4-7-5.5"/>
          <path d="m12 16v4"/>
          <path d="m8 20l8 0"/>
        </svg>
        <span>Voice & Persona</span>
      </a>
      <a href="#transcriber-section" class="relative flex items-center space-x-2 text-neutral-content/70 hover:text-white pb-2 text-sm transition-colors" data-section="transcriber">
        <!-- Lucide Type icon -->
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <polyline points="4,7 4,4 20,4 20,7"/>
          <line x1="9" y1="20" x2="15" y2="20"/>
          <line x1="12" y1="4" x2="12" y2="20"/>
        </svg>
        <span>Speech-to-Text</span>
      </a>
      <a href="#tools-section" class="relative flex items-center space-x-2 text-neutral-content/70 hover:text-white pb-2 text-sm transition-colors" data-section="tools">
        <!-- Lucide Wrench icon -->
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
        </svg>
        <span>Connected Tools</span>
      </a>
      <a href="#analysis-section" class="relative flex items-center space-x-2 text-neutral-content/70 hover:text-white pb-2 text-sm transition-colors" data-section="analysis">
        <!-- Lucide BarChart3 icon -->
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <path d="M3 3v18h18"/>
          <path d="m19 9-5 5-4-4-3 3"/>
        </svg>
        <span>Analytics</span>
      </a>
      <a href="#widget-section" class="relative flex items-center space-x-2 text-neutral-content/70 hover:text-white pb-2 text-sm transition-colors" data-section="widget">
        <!-- Lucide Layout icon -->
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
          <rect width="18" height="18" x="3" y="3" rx="2" ry="2"/>
          <line x1="3" y1="9" x2="21" y2="9"/>
          <line x1="9" y1="21" x2="9" y2="9"/>
        </svg>
        <span>Widget</span>
      </a>
    </div>
    
    <!-- Advanced as Ghost Button -->
    <button class="btn btn-ghost btn-sm text-amber-400 hover:text-amber-300 hover:bg-amber-400/10 border border-amber-400/30 rounded-2xl" data-section="advanced">
      <!-- Lucide Settings icon -->
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
        <path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/>
        <circle cx="12" cy="12" r="3"/>
      </svg>
      Advanced
    </button>
  </div>
</div>

<!-- Scrollable Content -->
<div class="space-y-6" style="padding-top: 140px;">

  <!-- Metrics Strip -->
  <div class="grid grid-cols-4 gap-3">
    <!-- Cost/min Tile -->
    <div class="bg-gradient-to-br from-cyan-50 to-cyan-100 dark:from-cyan-900/20 dark:to-cyan-800/20 rounded-2xl p-4 border border-cyan-200/50 dark:border-cyan-700/50 cursor-pointer hover:shadow-lg transition-all">
      <div class="flex items-center justify-between mb-2">
        <div class="text-xs font-medium text-cyan-700 dark:text-cyan-300 uppercase tracking-wider">Cost/min</div>
        <div class="w-2 h-2 rounded-full bg-cyan-500"></div>
      </div>
      <div class="text-xl font-bold text-cyan-900 dark:text-cyan-100">$0.15</div>
      <div class="text-xs text-cyan-600/80 dark:text-cyan-400/80">Web calls</div>
    </div>
    
    <!-- Avg Latency Tile -->
    <div class="bg-gradient-to-br from-amber-50 to-amber-100 dark:from-amber-900/20 dark:to-amber-800/20 rounded-2xl p-4 border border-amber-200/50 dark:border-amber-700/50 cursor-pointer hover:shadow-lg transition-all">
      <div class="flex items-center justify-between mb-2">
        <div class="text-xs font-medium text-amber-700 dark:text-amber-300 uppercase tracking-wider">Avg Latency</div>
        <div class="w-2 h-2 rounded-full bg-amber-500"></div>
      </div>
      <div class="text-xl font-bold text-amber-900 dark:text-amber-100">1.05s</div>
      <div class="text-xs text-amber-600/80 dark:text-amber-400/80">Response time</div>
    </div>
    
    <!-- Call Success Tile -->
    <div class="bg-gradient-to-br from-emerald-50 to-emerald-100 dark:from-emerald-900/20 dark:to-emerald-800/20 rounded-2xl p-4 border border-emerald-200/50 dark:border-emerald-700/50 cursor-pointer hover:shadow-lg transition-all">
      <div class="flex items-center justify-between mb-2">
        <div class="text-xs font-medium text-emerald-700 dark:text-emerald-300 uppercase tracking-wider">Call Success</div>
        <div class="w-2 h-2 rounded-full bg-emerald-500"></div>
      </div>
      <div class="text-xl font-bold text-emerald-900 dark:text-emerald-100">94.2%</div>
      <div class="text-xs text-emerald-600/80 dark:text-emerald-400/80">Success rate</div>
    </div>
    
    <!-- ASR WER Tile -->
    <div class="bg-gradient-to-br from-violet-50 to-violet-100 dark:from-violet-900/20 dark:to-violet-800/20 rounded-2xl p-4 border border-violet-200/50 dark:border-violet-700/50 cursor-pointer hover:shadow-lg transition-all">
      <div class="flex items-center justify-between mb-2">
        <div class="text-xs font-medium text-violet-700 dark:text-violet-300 uppercase tracking-wider">ASR WER</div>
        <div class="w-2 h-2 rounded-full bg-violet-500"></div>
      </div>
      <div class="text-xl font-bold text-violet-900 dark:text-violet-100">2.8%</div>
      <div class="text-xs text-violet-600/80 dark:text-violet-400/80">Error rate</div>
    </div>
  </div>

  <!-- MODEL Section Divider -->
  <div id="model-section" class="flex items-center space-x-3 text-sm text-base-content/60 uppercase tracking-wider font-semibold">
    <!-- Lucide Brain icon -->
    <svg class="w-5 h-5 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24" stroke-width="2">
      <path d="M12 2a10 10 0 1 0 10 10 4 4 0 0 1-5-5 4 4 0 0 1-5-5"/>
      <path d="M8.5 8.5a4 4 0 0 1 6 6"/>
      <path d="M12 2v2"/>
      <path d="m15.5 6.5 1.5-1.5"/>
    </svg>
    <span class="text-base-content/80">MODEL CONFIGURATION</span>
  </div>

  <!-- MODEL (Voysera-style collapsible) -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button type="button" aria-controls="collapsible-model-tab-content" aria-expanded="false" data-state="closed" class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4">
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-cyan-500 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="model-header">AI Model & Behavior</h2>
            <!-- Hover-only helper icon -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256" class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor" d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"></path>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">Configure your assistant's intelligence and conversational behavior</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true" class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor" d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"></path>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-model-tab-content" class="overflow-hidden transition-all duration-300 ease-in-out max-h-0" data-collapsed="true">
      <div class="p-6 space-y-6">
        <!-- Provider and Model Row -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Provider -->
        <div class="space-y-2">
          <label class="flex items-center space-x-2 text-sm font-medium text-base-content">
            <span>Provider</span>
          </label>
          <select class="select select-bordered w-full bg-base-200/50">
            <option selected>OpenAI</option>
            <option>Anthropic</option>
            <option>Google</option>
          </select>
        </div>

        <!-- Model -->
        <div class="space-y-2">
          <label class="flex items-center space-x-2 text-sm font-medium text-base-content">
            <span>Model</span>
            <div class="relative group">
              <svg class="w-4 h-4 text-base-content/50 cursor-help hover:text-primary transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <!-- Custom Tooltip -->
              <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gradient-to-r from-primary to-secondary text-primary-content text-xs rounded-lg shadow-lg opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 ease-out group-hover:scale-105 z-50 w-64">
                <div class="relative">
                  Choose the AI model that will power your assistant. Different models have varying capabilities, response quality, and cost.
                  <!-- Arrow -->
                  <div class="absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-primary"></div>
                </div>
              </div>
            </div>
          </label>
          <select class="select select-bordered w-full bg-base-200/50">
            <option selected>GPT 4o Cluster</option>
            <option>GPT 4o</option>
            <option>GPT 3.5 Turbo</option>
          </select>
        </div>
      </div>

      <!-- First Message Mode -->
      <div class="space-y-2">
        <label class="flex items-center space-x-2 text-sm font-medium text-base-content">
          <span>First Message Mode</span>
          <div class="relative group">
            <svg class="w-4 h-4 text-base-content/50 cursor-help hover:text-secondary transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <!-- Custom Tooltip -->
            <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gradient-to-r from-secondary to-accent text-secondary-content text-xs rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 ease-out group-hover:scale-105 z-50 w-64">
              <div class="relative">
                Determines who speaks first when the call begins. 'Assistant speaks first' means your AI will greet the caller immediately.
                <!-- Arrow -->
                <div class="absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-secondary"></div>
              </div>
            </div>
          </div>
        </label>
        <select class="select select-bordered w-full bg-base-200/50">
          <option selected>Assistant speaks first</option>
          <option>User speaks first</option>
          <option>Both speak</option>
        </select>
      </div>

      <!-- First Message -->
      <div class="space-y-2">
        <label class="flex items-center space-x-2 text-sm font-medium text-base-content">
          <span>First Message</span>
          <div class="relative group">
            <svg class="w-4 h-4 text-base-content/50 cursor-help hover:text-accent transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
            <!-- Custom Tooltip -->
            <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-2 bg-gradient-to-r from-accent to-info text-accent-content text-xs rounded-lg shadow-xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 ease-out group-hover:scale-105 z-50 w-64">
              <div class="relative">
                The exact message your assistant will say when the call begins. This should be a warm, professional greeting that sets the tone for the conversation.
                <!-- Arrow -->
                <div class="absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-accent"></div>
              </div>
            </div>
          </div>
        </label>
        <input type="text" class="input input-bordered w-full bg-base-200/50" value="Thank you for calling Wellness Partners. This is Riley, your scheduling assistant. How may I help you today?" />
      </div>

      <!-- System Prompt -->
      <div class="space-y-2">
        <label class="flex items-center justify-between text-sm font-medium text-base-content">
          <div class="flex items-center space-x-2">
            <span>System Prompt</span>
            <div class="relative group">
              <svg class="w-4 h-4 text-base-content/50 cursor-help hover:text-info transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <!-- Custom Tooltip -->
              <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-4 py-3 bg-gradient-to-br from-info via-info to-primary text-info-content text-xs rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 ease-out group-hover:scale-105 z-50 w-72">
                <div class="relative">
                  <div class="flex items-center mb-1">
                    <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
                    </svg>
                    <span class="font-semibold">System Prompt</span>
                  </div>
                  Instructions that define your assistant's personality, behavior, and knowledge. This tells the AI how to act, what it knows, and how to respond to different situations.
                  <!-- Arrow -->
                  <div class="absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-info"></div>
                </div>
              </div>
            </div>
          </div>
          <button class="btn btn-primary btn-sm">
            <svg class="w-4 h-4 mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"></path>
            </svg>
            Generate
          </button>
        </label>
        <textarea class="textarea textarea-bordered w-full bg-base-200/50 h-32 resize-none" placeholder="Add your prompt here..."></textarea>
      </div>

      <!-- Files -->
      <div class="space-y-2">
        <label class="text-sm font-medium text-base-content">Files</label>
        <select class="select select-bordered w-full bg-base-200/50">
          <option selected>Select Files</option>
          <option>Upload new file</option>
          <option>From library</option>
        </select>
      </div>

      <!-- Max Tokens and Temperature Row -->
      <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
        <!-- Max Tokens -->
        <div class="space-y-2">
          <label class="flex items-center space-x-2 text-sm font-medium text-base-content">
            <span>Max Tokens</span>
            <div class="relative group">
              <svg class="w-4 h-4 text-base-content/50 cursor-help hover:text-warning transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
              </svg>
              <!-- Custom Tooltip -->
              <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-4 py-3 bg-gradient-to-tr from-warning to-orange-400 text-warning-content text-xs rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 ease-out group-hover:scale-105 z-50 w-72">
                <div class="relative">
                  <div class="flex items-center mb-1">
                    <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"></path>
                    </svg>
                    <span class="font-semibold">Max Tokens</span>
                  </div>
                  Maximum number of tokens (words/parts of words) the AI can use in each response. Higher values allow longer responses but increase cost. <strong>250 tokens â‰ˆ 180-200 words.</strong>
                  <!-- Arrow -->
                  <div class="absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-warning"></div>
                </div>
              </div>
            </div>
          </label>
          <input type="number" class="input input-bordered w-full bg-base-200/50" value="250" />
        </div>

        <!-- Temperature -->
        <div class="space-y-2">
          <label class="flex items-center justify-between text-sm font-medium text-base-content">
            <div class="flex items-center space-x-2">
              <span>Temperature</span>
              <div class="relative group">
                <svg class="w-4 h-4 text-base-content/50 cursor-help hover:text-error transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <!-- Custom Tooltip -->
                <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-4 py-3 bg-gradient-to-bl from-error via-red-500 to-rose-500 text-error-content text-xs rounded-xl shadow-2xl opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-300 ease-out group-hover:scale-105 z-50 w-72">
                  <div class="relative">
                    <div class="flex items-center mb-1">
                      <svg class="w-3 h-3 mr-1" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM4.332 8.027a6.012 6.012 0 011.912-2.706C6.512 5.73 6.974 6 7.5 6A1.5 1.5 0 019 7.5V8a2 2 0 004 0v-.5C13 6.12 13.88 5.24 15.26 5.24c1.38 0 2.5 1.12 2.5 2.5v.5h.5a.5.5 0 01.5.5v3a.5.5 0 01-.5.5H18v.5a.5.5 0 01-.5.5h-15a.5.5 0 01-.5-.5v-3a.5.5 0 01.5-.5h.5V8.5c0-.276.224-.5.5-.5h.332z" clip-rule="evenodd"></path>
                      </svg>
                      <span class="font-semibold">Temperature</span>
                    </div>
                    Controls how creative or predictable the AI's responses are. <strong>0 = very predictable</strong> and consistent, <strong>1 = very creative</strong> and varied. <em>0.5 is a good balance for most assistants.</em>
                    <!-- Arrow -->
                    <div class="absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-error"></div>
                  </div>
                </div>
              </div>
            </div>
            <span class="text-sm text-base-content/70">0.5</span>
          </label>
          <input type="range" min="0" max="1" step="0.1" value="0.5" class="range range-primary" />
        </div>
      </div>
      </div>
    </div>
  </section>

  <!-- VOICE Section Divider -->
  <div id="voice-section" class="flex items-center space-x-2 text-sm text-base-content/60 uppercase tracking-wide">
    <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
    </svg>
    <span>VOICE</span>
  </div>

  <!-- Voice Configuration subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-voice-config-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="voice-config-header">Voice Configuration</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">Select a voice from the list, or sync your voice library if it's missing. If errors persist, enable custom voice and add a voice ID.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-voice-config-tab-content" class="overflow-hidden transition-all duration-300 ease-in-out max-h-0" data-collapsed="true">
      <div class="p-6 space-y-6">
        <!-- Voice Configuration content will be added later -->
      </div>
    </div>
  </section>

  <!-- Additional Configuration subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-voice-additional-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11a7 7 0 01-7 7m0 0a7 7 0 01-7-7m7 7v4m0 0H8m4 0h4m-4-8a3 3 0 01-3-3V5a3 3 0 116 0v6a3 3 0 01-3 3z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="voice-additional-header">Additional Configuration</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">Configure additional settings for the voice of your assistant.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-voice-additional-tab-content" class="overflow-hidden transition-all duration-300 ease-in-out max-h-0" data-collapsed="true">
      <div class="p-6 space-y-6">
        <!-- Additional Configuration content will be added later -->
      </div>
    </div>
  </section>

  <!-- TRANSCRIBER Section Divider -->
  <div id="transcriber-section" class="flex items-center space-x-2 text-sm text-base-content/60 uppercase tracking-wide">
    <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"></path>
    </svg>
    <span>TRANSCRIBER</span>
  </div>

  <!-- TRANSCRIBER (Vapi-style collapsible) -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-transcriber-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z" />
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="transcriber-header">Transcriber</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">This section allows you to configure the transcription settings for the assistant.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-transcriber-tab-content" class="overflow-hidden transition-all duration-300 ease-in-out max-h-0" data-collapsed="true">
      <div class="p-6 space-y-6">
      <!-- Provider and Language Row -->
      <div class="grid grid-cols-2 gap-6">
        <!-- Provider -->
        <div class="space-y-2">
          <label class="text-sm font-medium text-base-content">Provider</label>
          <div class="relative">
            <select class="select w-full bg-base-300/50 border-base-content/20 text-base-content">
              <option selected>ðŸ”µ Deepgram</option>
              <option>OpenAI Whisper</option>
              <option>AssemblyAI</option>
            </select>
          </div>
        </div>

        <!-- Language -->
        <div class="space-y-2">
          <label class="text-sm font-medium text-base-content">Language</label>
          <div class="relative">
            <select class="select w-full bg-base-300/50 border-base-content/20 text-base-content">
              <option selected>En</option>
              <option>Es</option>
              <option>Fr</option>
              <option>De</option>
            </select>
          </div>
          <div class="text-xs text-blue-400">
            Pro tip: If you want to support both English and Spanish, you can set the language to <span class="font-medium">multi</span> and use <span class="font-medium">ElevenLabs Turbo 2.5</span> in the Voice tab.
          </div>
        </div>
      </div>

      <!-- Model -->
      <div class="space-y-2">
        <label class="text-sm font-medium text-base-content">Model</label>
        <select class="select w-full bg-base-300/50 border-base-content/20 text-base-content">
          <option selected>Nova 3</option>
          <option>Nova 2</option>
          <option>Base</option>
        </select>
      </div>

      <!-- Background Denoising Enabled -->
      <div class="flex items-start space-x-3 py-3">
        <div class="flex items-center justify-center w-5 h-5 mt-0.5">
          <svg class="w-4 h-4 text-base-content/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15.536 8.464a5 5 0 010 7.072m2.828-9.9a9 9 0 010 12.728M6.343 6.343a8 8 0 000 11.314m2.829-9.9a5 5 0 000 7.07"></path>
          </svg>
        </div>
        <div class="flex-1">
          <div class="flex items-center justify-between">
            <div>
              <h3 class="text-sm font-medium text-base-content">Background Denoising Enabled</h3>
              <p class="text-xs text-base-content/60 mt-1">Filter background noise while the user is talking.</p>
            </div>
            <input type="checkbox" class="toggle toggle-primary" checked>
          </div>
        </div>
      </div>

      <!-- Separator -->
      <hr class="border-base-content/20 my-4">

      <!-- Confidence Threshold -->
      <div class="flex items-start space-x-3 py-3">
        <div class="flex items-center justify-center w-5 h-5 mt-0.5">
          <svg class="w-4 h-4 text-base-content/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
          </svg>
        </div>
        <div class="flex-1">
          <h3 class="text-sm font-medium text-base-content">Confidence Threshold</h3>
          <p class="text-xs text-base-content/60 mt-1 mb-4">Transcripts with a confidence score below this threshold will be filtered out.</p>
          <div class="relative">
            <input type="range" min="0" max="1" step="0.1" value="0.4" class="range range-primary w-full">
            <div class="flex justify-between text-xs text-base-content/60 mt-1">
              <span>0</span>
              <span>1.0</span>
            </div>
            <div class="absolute -top-8 right-0">
              <span class="text-xs font-medium text-base-content">0.4</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Separator -->
      <hr class="border-base-content/20 my-4">

      <!-- Use Numerals -->
      <div class="flex items-start space-x-3 py-3">
        <div class="flex items-center justify-center w-5 h-5 mt-0.5">
          <svg class="w-4 h-4 text-base-content/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
          </svg>
        </div>
        <div class="flex-1">
          <div class="flex items-center justify-between">
            <div>
              <h3 class="text-sm font-medium text-base-content">Use Numerals</h3>
              <p class="text-xs text-base-content/60 mt-1">Convert numbers from words to digits in transcription.</p>
            </div>
            <input type="checkbox" class="toggle toggle-primary" checked>
          </div>
        </div>
      </div>

      <!-- Separator -->
      <hr class="border-base-content/20 my-4">

      <!-- Keywords -->
      <div class="flex items-start space-x-3 py-3">
        <div class="flex items-center justify-center w-5 h-5 mt-0.5">
          <svg class="w-4 h-4 text-base-content/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"></path>
          </svg>
        </div>
        <div class="flex-1">
          <h3 class="text-sm font-medium text-base-content mb-3">Keyterms</h3>
          <textarea 
            class="textarea w-full bg-base-300/50 border-base-content/20 text-base-content min-h-[120px] resize-none" 
            placeholder=""
          ></textarea>
          <p class="text-xs text-base-content/60 mt-2">Enter keywords separated by spaces. These will be used as key terms for transcription.</p>
        </div>
      </div>
      </div>
    </div>
  </section>

  <!-- TOOLS Section Divider -->
  <div id="tools-section" class="flex items-center space-x-2 text-sm text-base-content/60 uppercase tracking-wide">
    <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
    </svg>
    <span>TOOLS</span>
  </div>

  <!-- Predefined Functions subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-tools-predefined-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="tools-predefined-header">Predefined Functions</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">We've pre-built functions for common use cases. You can enable them and configure them below.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-tools-predefined-tab-content" class="p-6 space-y-6" hidden>
      <!-- Predefined Functions content will be added later -->
    </div>
  </section>

  <!-- Custom Functions subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-tools-custom-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="tools-custom-header">Custom Functions</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">Define your custom functions here to enhance your assistant's capabilities. You can use your own code or tools like Pipedream or Make for the setup.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-tools-custom-tab-content" class="p-6 space-y-6" hidden>
      <!-- Custom Functions content will be added later -->
    </div>
  </section>

  <!-- ANALYSIS Section Divider -->
  <div id="analysis-section" class="flex items-center space-x-2 text-sm text-base-content/60 uppercase tracking-wide">
    <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
    </svg>
    <span>ANALYSIS</span>
  </div>

  <!-- Summary subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-analysis-summary-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="analysis-summary-header">Summary</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">This is the prompt that's used to summarize the call. The output is stored in call.analysis.summary. You can also find the summary in the Call Logs Page.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-analysis-summary-tab-content" class="p-6 space-y-6" hidden>
      <!-- Summary content will be added later -->
    </div>
  </section>

  <!-- Success Evaluation subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-analysis-success-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="analysis-success-header">Success Evaluation</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">Evaluate if your call was successful. You can use Rubric standalone or in combination with Success Evaluation Prompt. If both are provided, they are concatenated into appropriate instructions.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-analysis-success-tab-content" class="p-6 space-y-6" hidden>
      <!-- Success Evaluation content will be added later -->
    </div>
  </section>

  <!-- Structured Data subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-analysis-data-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="analysis-data-header">Structured Data</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">Extract structured data from call conversation. You can use Data Schema standalone or in combination with Structured Data Prompt. If both are provided, they are concatenated into appropriate instructions.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-analysis-data-tab-content" class="p-6 space-y-6" hidden>
      <!-- Structured Data content will be added later -->
    </div>
  </section>

  <!-- ADVANCED Section Divider -->
  <div id="advanced-section" class="flex items-center space-x-2 text-sm text-base-content/60 uppercase tracking-wide">
    <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"></path>
    </svg>
    <span>ADVANCED</span>
  </div>

  <!-- Privacy subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-advanced-privacy-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="advanced-privacy-header">Privacy</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">This section allows you to configure the privacy settings for the assistant.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-advanced-privacy-tab-content" class="p-6 space-y-6" hidden>
      <!-- Privacy content will be added later -->
    </div>
  </section>

  <!-- Start Speaking Plan subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-advanced-speaking-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 12v1m9-6h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="advanced-speaking-header">Start Speaking Plan</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">This is the plan for when the assistant should start talking.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-advanced-speaking-tab-content" class="p-6 space-y-6" hidden>
      <!-- Start Speaking Plan content will be added later -->
    </div>
  </section>

  <!-- Voicemail Detection subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-advanced-voicemail-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="advanced-voicemail-header">Voicemail Detection</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">Configure how the assistant detects and handles voicemail.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-advanced-voicemail-tab-content" class="p-6 space-y-6" hidden>
      <!-- Voicemail Detection content will be added later -->
    </div>
  </section>

  <!-- Stop Speaking Plan subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-advanced-stop-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="advanced-stop-header">Stop Speaking Plan</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">This is the plan for when the assistant should stop talking.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-advanced-stop-tab-content" class="p-6 space-y-6" hidden>
      <!-- Stop Speaking Plan content will be added later -->
    </div>
  </section>

  <!-- Call Timeout Settings subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-advanced-timeout-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="advanced-timeout-header">Call Timeout Settings</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">Configure when the assistant should end a call based on silence or duration.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-advanced-timeout-tab-content" class="p-6 space-y-6" hidden>
      <!-- Call Timeout Settings content will be added later -->
    </div>
  </section>

  <!-- Keypad Input Settings subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-advanced-keypad-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="advanced-keypad-header">Keypad Input Settings</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">Configure whether a user can input digits via the keypad, and when to process the input.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-advanced-keypad-tab-content" class="p-6 space-y-6" hidden>
      <!-- Keypad Input Settings content will be added later -->
    </div>
  </section>

  <!-- Messaging subsection -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-advanced-messaging-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="advanced-messaging-header">Messaging</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">Message configuration for messages that are sent to and from the assistant.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-advanced-messaging-tab-content" class="p-6 space-y-6" hidden>
      <!-- Messaging content will be added later -->
    </div>
  </section>

  <!-- WIDGET Section Divider -->
  <div id="widget-section" class="flex items-center space-x-2 text-sm text-base-content/60 uppercase tracking-wide">
    <svg class="w-4 h-4 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"></path>
    </svg>
    <span>WIDGET</span>
  </div>

  <!-- WIDGET (Vapi-style collapsible) -->
  <section class="rounded-lg border border-base-content/10 bg-base-100 overflow-hidden">
    <!-- Header button -->
    <button
      type="button"
      aria-controls="collapsible-widget-tab-content"
      aria-expanded="false"
      data-state="closed"
      class="group flex w-full flex-row items-center justify-between border-b bg-base-200/40 p-4"
    >
      <div class="flex flex-row items-start gap-3">
        <!-- Section icon -->
        <svg class="w-4 h-4 text-primary mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"></path>
        </svg>

        <!-- Title + helper -->
        <div class="flex flex-col items-start">
          <div class="flex flex-row items-center">
            <h2 class="text-lg font-medium text-base-content" data-testid="widget-header">Widget</h2>
            <!-- Hover-only helper icon (appears on hover like Vapi) -->
            <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 256 256"
                 class="ml-2 cursor-pointer text-base-content/50 opacity-0 transition-opacity group-hover:opacity-100">
              <path fill="currentColor"
                d="M240,88.23a54.43,54.43,0,0,1-16,37L189.25,160a54.27,54.27,0,0,1-38.63,16h-.05A54.63,54.63,0,0,1,96,119.84a8,8,0,0,1,16,.45A38.62,38.62,0,0,0,150.58,160h0a38.39,38.39,0,0,0,27.31-11.31l34.75-34.75a38.63,38.63,0,0,0-54.63-54.63l-11,11A8,8,0,0,1,135.7,59l11-11A54.65,54.65,0,0,1,224,48,54.86,54.86,0,0,1,240,88.23ZM109,185.66l-11,11A38.41,38.41,0,0,1,70.6,208h0a38.63,38.63,0,0,1-27.29-65.94L78,107.31A38.63,38.63,0,0,1,144,135.71a8,8,0,0,0,16,.45A54.86,54.86,0,0,0,144,96a54.65,54.65,0,0,0-77.27,0L32,130.75A54.62,54.62,0,0,0,70.56,224h0a54.28,54.28,0,0,0,38.64-16l11-11A8,8,0,0,0,109,185.66Z"/>
            </svg>
          </div>
          <p class="text-xs text-base-content/60">Add this conversational widget to your website. Visitors can talk or chat with your AI assistant directly from any page.</p>
        </div>
      </div>

      <!-- Right chevron: rotates when expanded -->
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" aria-hidden="true"
           class="h-6 w-6 transform transition-transform duration-200 group-aria-expanded:rotate-180">
        <path fill="currentColor"
          d="M213.66,101.66l-80,80a8,8,0,0,1-11.32,0l-80-80A8,8,0,0,1,53.66,90.34L128,164.69l74.34-74.35a8,8,0,0,1,11.32,11.32Z"/>
      </svg>
    </button>

    <!-- Collapsible content -->
    <div id="collapsible-widget-tab-content" class="p-6 space-y-6" hidden>
      <!-- Widget content will be added later -->
    </div>
  </section>
</div>


<!-- Enhanced JS for smooth collapsible animations and tab navigation -->
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Function to toggle collapsible sections with smooth animation
    function toggleCollapse(button, contentId) {
        const content = document.getElementById(contentId);
        const isCollapsed = content.dataset.collapsed === 'true';
        
        if (isCollapsed) {
            // Expanding
            content.style.maxHeight = content.scrollHeight + 'px';
            content.dataset.collapsed = 'false';
            button.setAttribute('aria-expanded', 'true');
            button.setAttribute('data-state', 'open');
        } else {
            // Collapsing
            content.style.maxHeight = '0px';
            content.dataset.collapsed = 'true';
            button.setAttribute('aria-expanded', 'false');
            button.setAttribute('data-state', 'closed');
        }
    }
    
    // Add click handlers using event delegation for better performance
    document.addEventListener('click', function(e) {
        const button = e.target.closest('button[aria-controls]');
        if (!button) return;
        
        e.preventDefault();
        const contentId = button.getAttribute('aria-controls');
        toggleCollapse(button, contentId);
    });
    
    // Handle window resize to recalculate heights for expanded sections
    window.addEventListener('resize', function() {
        const expandedSections = document.querySelectorAll('[data-collapsed="false"]');
        expandedSections.forEach(section => {
            section.style.maxHeight = section.scrollHeight + 'px';
        });
    });
    
    // Tab navigation with smooth scrolling
    function handleTabNavigation() {
        const tabs = document.querySelectorAll('a[data-section]');
        const sections = document.querySelectorAll('[id$="-section"]');
        
        // Click handlers for tabs
        tabs.forEach(tab => {
            tab.addEventListener('click', function(e) {
                e.preventDefault();
                
                // Remove active styling from all tabs
                tabs.forEach(t => {
                    t.classList.remove('text-white', 'border-b-2', 'border-white', 'font-medium');
                    t.classList.add('text-neutral-content/70');
                    if (t.textContent.trim() === 'Advanced') {
                        t.classList.remove('text-neutral-content/70');
                        t.classList.add('text-red-400');
                    }
                });
                
                // Add active styling to clicked tab
                this.classList.remove('text-neutral-content/70', 'text-red-400');
                this.classList.add('text-white', 'border-b-2', 'border-white', 'font-medium');
                
                // Get target section
                const targetId = this.getAttribute('href').substring(1);
                const targetElement = document.getElementById(targetId);
                
                if (targetElement) {
                    // Smooth scroll to section with offset for fixed header
                    const headerOffset = 160; // Account for fixed header height + padding
                    const elementPosition = targetElement.getBoundingClientRect().top;
                    const offsetPosition = elementPosition + window.pageYOffset - headerOffset;
                    
                    window.scrollTo({
                        top: offsetPosition,
                        behavior: 'smooth'
                    });
                }
            });
        });
        
        // Update active tab based on scroll position
        function updateActiveTab() {
            const scrollPosition = window.scrollY + 180; // Offset for better detection
            
            sections.forEach((section, index) => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.offsetHeight;
                const sectionBottom = sectionTop + sectionHeight;
                
                if (scrollPosition >= sectionTop && scrollPosition < sectionBottom) {
                    tabs.forEach(t => {
                        t.classList.remove('text-white', 'border-b-2', 'border-white', 'font-medium');
                        t.classList.add('text-neutral-content/70');
                        if (t.textContent.trim() === 'Advanced') {
                            t.classList.remove('text-neutral-content/70');
                            t.classList.add('text-red-400');
                        }
                    });
                    if (tabs[index]) {
                        tabs[index].classList.remove('text-neutral-content/70', 'text-red-400');
                        tabs[index].classList.add('text-white', 'border-b-2', 'border-white', 'font-medium');
                    }
                }
            });
        }
        
        // Throttled scroll listener for performance
        let scrollTimeout;
        window.addEventListener('scroll', function() {
            if (scrollTimeout) {
                clearTimeout(scrollTimeout);
            }
            scrollTimeout = setTimeout(updateActiveTab, 10);
        });
    }
    
    // Initialize tab navigation
    handleTabNavigation();
});
</script>
{% endblock %}
